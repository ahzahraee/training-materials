\subchapter{Kernel sources}{Objective: Learn how to get the kernel
  sources and patch them.}

After this lab, you will be able to:
\begin{itemize}
\item Get the kernel sources from the official location
\item Apply kernel patches
\end{itemize}

\section{Setup}

Create the \code{$HOME/__SESSION_NAME__-labs/kernel} directory and go into it.

\section{Get the sources}

Go to the Linux kernel web site (\url{https://kernel.org/}) and
identify the latest stable version.

Just to make sure you know how to do it, check the version of the
Linux kernel running on your machine.
%uname -r

We will use \texttt{linux-\workingkernel.x}, which this lab was tested with.

To practice with the \code{patch} command later, download the full \texttt\basekernel\
sources. Unpack the archive, which creates a \texttt{linux-\basekernel}
directory.

Remember that you can use \code{wget <URL>} on the command
line to download files.

\section{Apply patches}

Download the patch files corresponding to the latest \texttt\workingkernel\ stable
release: a first patch to move from \texttt\basekernel\ to
\texttt\workingkernel\ and if one exists, a second patch to move from
\texttt\workingkernel\ to \texttt{\workingkernel.x}.

Without uncompressing them to a separate file, apply the patches to the Linux
source directory.

%xzcat ../patchfile.xz | patch -p1 (--dry-run)
%patch -p1 (--dry-run) < ../diff_file

View one of the patch files with \code{vi} or \code{gvim}
(if you prefer a graphical editor), to understand the information carried
by such a file. How are described added or removed files?

Rename the \texttt{linux-\basekernel} directory to \texttt{linux-\workingkernel.<x>}.
